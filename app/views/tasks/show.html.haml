.row.align-items-center
  =back_link(tasks_path)
  %h1= @task.title

.row
  %p=task_due_date_icon(@task)

.row
  .btn-group
    =link_to fa_icon('fa-edit icon', 'Edit'), edit_task_path, class: 'btn btn-sm btn-outline-primary'
    =link_to fa_icon('fa-trash-alt icon', 'Delete'), task_path(@task), class: 'btn btn-sm btn-outline-primary', 
        method: :delete,
        data: { confirm: 'Are you sure?' }

.row.mt-2
  %a.object-link{href: "#{edit_task_path}"}
    %p.desc.border.p-2.rounded= @task.description

 
.row.align-items-center.mt-5{style: 'font-size: .9rem;'}
  .col-auto.mr-auto
    %h2 Subtasks
  .col-auto
  =link_to fa_icon('fa-plus-circle icon', 'Add Subtask'), "#subtask", class: 'btn btn-sm btn-outline-primary', 'data-toggle': "collapse", role: "button", 'aria-expanded':"false", 'aria-controls':"subtask"
  %table.table
    %caption
      ="#{@task.subs.count} Subtasks"
    %tbody
    - @task.subs.each do |sub|
      %tr{class: "#{'row-completed' if sub.completed?}"}
        %th
          =sub.title
          %br
          %small.desc= sub.description
        %td.nowrap= task_due_date(sub)
        %td 
          - unless sub.completed?
            = link_to fa_icon('fa-check'), sub_path(sub, completed: true, completed_at: Time.now), method: :patch, class: 'btn btn-sm btn-light'
          - else
            = link_to fa_icon('fa-undo'), sub_path(sub, completed: false, completed_at: nil), method: :patch, class: 'btn btn-sm btn-light'


        
      


.row.collapse{id:'subtask'}
  .col-auto
    = simple_form_for [@task , @task.subs.build] do |f|
      -# - if @task.errors.any?
      -#   %samp#error_explanation
      -#     %details{:open => ""}
      -#       %summary
      -#         = pluralize(@task.errors.count, "error")
      -#         prohibited
      -#         this task from being saved:
      -#       %ul
      -#         - @task.errors.full_messages.each do |msg|
      -#           %li= msg
      %p
        = f.label :title
        %br/
        = f.text_field :title
      %p
        = f.label :due_date
        %br/
        = f.datetime_select :due_date  
      %p
        = f.label :description
        %br/
        = f.text_area :description
      %p
        = link_to (content_tag :button, 'Cancel', class: 'btn btn-sm btn-light'), task_path(@task)
        = f.submit 'Save Subtask', class: 'btn btn-sm btn-success' 

-# = debug @task